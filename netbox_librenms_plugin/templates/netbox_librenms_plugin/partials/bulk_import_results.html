{# Results modal for bulk import operation #}
<div class="modal-header {% if failed|length == 0 %}bg-success text-white{% elif success|length == 0 %}bg-danger text-white{% else %}bg-warning{% endif %}">
    <h5 class="modal-title">
        {% if failed|length == 0 %}
            <i class="mdi mdi-check-circle"></i> Bulk Import Completed
        {% elif success|length == 0 %}
            <i class="mdi mdi-alert-circle"></i> Bulk Import Failed
        {% else %}
            <i class="mdi mdi-alert"></i> Bulk Import Completed with Errors
        {% endif %}
    </h5>
    <button type="button" class="btn-close {% if failed|length == 0 %}btn-close-white{% endif %}" data-bs-dismiss="modal"></button>
</div>
<div class="modal-body">
    {# Summary #}
    <div class="row text-center mb-4">
        <div class="col-4">
            <div class="card border-success">
                <div class="card-body">
                    <div class="display-6 text-success">{{ success|length }}</div>
                    <div class="text-muted">Succeeded</div>
                </div>
            </div>
        </div>
        <div class="col-4">
            <div class="card border-danger">
                <div class="card-body">
                    <div class="display-6 text-danger" data-failed-count="{{ failed|length }}">{{ failed|length }}</div>
                    <div class="text-muted">Failed</div>
                </div>
            </div>
        </div>
        <div class="col-4">
            <div class="card border-secondary">
                <div class="card-body">
                    <div class="display-6 text-secondary">{{ skipped|length }}</div>
                    <div class="text-muted">Skipped</div>
                </div>
            </div>
        </div>
    </div>

    {# Successfully imported devices #}
    {% if success %}
    <div class="card mb-3 border-success">
        <div class="card-header bg-success text-white">
            <strong><i class="mdi mdi-check-circle"></i> Successfully Imported ({{ success|length }})</strong>
        </div>
        <div class="card-body">
            <ul class="list-unstyled mb-0">
                {% for item in success %}
                <li class="mb-2">
                    <i class="mdi mdi-check text-success"></i>
                    <a href="{% url 'dcim:device' pk=item.device.pk %}" target="_blank">
                        <strong>{{ item.device.name }}</strong>
                    </a>
                    {% if item.synced %}
                        <div class="ms-4 small text-muted">
                            {% if item.synced.interfaces %}
                                <span class="badge bg-info me-1">{{ item.synced.interfaces }} interfaces</span>
                            {% endif %}
                            {% if item.synced.cables %}
                                <span class="badge bg-info me-1">{{ item.synced.cables }} cables</span>
                            {% endif %}
                            {% if item.synced.ips %}
                                <span class="badge bg-info me-1">{{ item.synced.ips }} IPs</span>
                            {% endif %}
                        </div>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}

    {# Failed imports #}
    {% if failed %}
    <div class="card mb-3 border-danger">
        <div class="card-header bg-danger text-white">
            <strong><i class="mdi mdi-alert-circle"></i> Failed Imports ({{ failed|length }})</strong>
        </div>
        <div class="card-body">
            <ul class="list-unstyled mb-0">
                {% for item in failed %}
                <li class="mb-3">
                    <i class="mdi mdi-close text-danger"></i>
                    <strong>Device ID {{ item.device_id }}</strong>
                    <div class="ms-4 small">
                        <span class="text-danger">{{ item.error }}</span>
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}

    {# Skipped devices #}
    {% if skipped %}
    <div class="card border-secondary">
        <div class="card-header">
            <strong><i class="mdi mdi-minus-circle"></i> Skipped ({{ skipped|length }})</strong>
        </div>
        <div class="card-body">
            <ul class="list-unstyled mb-0">
                {% for item in skipped %}
                <li class="mb-2">
                    <i class="mdi mdi-minus text-secondary"></i>
                    <strong>Device ID {{ item.device_id }}</strong>
                    <div class="ms-4 small text-muted">{{ item.reason }}</div>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
    {% if success %}
    <button type="button" class="btn btn-primary" onclick="window.location.reload();">
        <i class="mdi mdi-refresh"></i> Refresh Page
    </button>
    {% endif %}
</div>
